<!-- Encabezado -->
<div class="header">
    <div class="logo">
        <img src="assets/logo.png" alt="Logo Grafo" />
    </div>
    <div class="profile-icon">ðŸ‘¤</div>
</div>

<!-- Contenido -->
<div class="container">
    <h2>Crear nuevo viaje</h2>

    <!-- Tarjeta del formulario -->
    <div class="form-card">
        <form (submit)="buscarViaje($event)">
            <div>
                <label for="origen">Origen:</label>
                <input id="origen" type="text" #origenInput placeholder="Ej: CÃ³rdoba" />
                <!-- BotÃ³n para confirmar origen -->
                <button type="button" (click)="confirmarOrigen()">OK</button>
            </div>

            <div>
                <label for="destino">Destino:</label>
                <input id="destino" type="text" #destinoInput placeholder="SeleccionÃ¡ en el mapa" readonly />
            </div>

            <div>
                <label for="fechaSalida">Fecha de salida:</label>
                <input id="fechaSalida" type="date" #fechaSalidaInput />
            </div>

            <!-- Pedir selecciÃ³n de hora de salida-->
            <label for="horaSalida">Hora de salida:</label>
            <input
            id="horaSalida"
            type="time"
            class="form-control"
            [(ngModel)]="horaSalida"
            name=horaSalida
            />

            <!-- Mostrar los camiones agregados -->
            <div>
                <label>Camiones agregados:</label>
                <ul>
                    <li *ngFor="let camion of camionesSeleccionados">
                        {{ camion.tipo }} - {{ camion.semirremolque }} - {{ camion.acoplado }}
                    </li>
                </ul>
            </div>

            <!-- BotÃ³n para abrir selector de vehÃ­culo -->
            <div>
                <button type="button" (click)="abrirSelectorVehiculo()">ðŸš› Buscar unidades</button>
            </div>

            <button type="submit" class="btn-submit">ðŸšš Buscar Viaje</button>
        </form>
    </div>

    <!-- Contenedor del mapa -->
    <div id="map" style="height: 400px;"></div>
</div>

<!-- Modal de selecciÃ³n de vehÃ­culo -->
<div *ngIf="mostrarSelector" class="modal">
    <div class="modal-content">
        <h3>Seleccionar camiÃ³n</h3>

        <div>
            <label for="tipoCamion">Tipo de camiÃ³n:  </label>
            <select id="tipoCamion" [(ngModel)]="tipoCamionSeleccionado" name="tipoCamionSeleccionado">
                <option value="" disabled selected>Seleccione un tipo</option>
                    <option *ngFor="let tipo of tiposCamion" [value]="tipo">
                        {{ tipo }}
                    </option>
            </select>
        </div>

        <div>
            <label for="remolque">Tipo de semirremolque:</label>
            <select id="remolque" [(ngModel)]="semirremolqueSeleccionado" name="semirremolqueSeleccionado" (change)="toggleAcoplado()">
            <option value="" disabled selected>Seleccione un remolque</option>
                <option *ngFor="let tipo of tiposSemirremolque" [value]="tipo">
                    {{ tipo }}
                </option>
            </select>
        </div>

        <!-- Campo de tipo de semirremolque-->
        <label for="acoplado">Tipo de Acoplado:  </label>
        <select id="acoplado" [(ngModel)]="acopladoSeleccionado" name="acopladoSeleccionado" (change)="toggleSemirremolque()">
        <option value="" disabled selected>Seleccione un Acoplado</option>
            <option *ngFor="let tipo of tiposAcoplado" [value]="tipo">
                {{ tipo }}
            </option>
        </select>

        <div class="modal-actions">
            <button type="button" (click)="agregarCamion()">Agregar camiÃ³n</button>
            <button type="button" (click)="cerrarSelector()">Cancelar</button>
        </div>
    </div>
</div>


<!-- Modal de confirmaciÃ³n de viaje -->
<div *ngIf="mostrarResumen" class="overlay">
  <div class="modal-resumen">
    <h2>Resumen del viaje</h2>

    <div class="detalle">
      <h3>Camiones seleccionados:</h3>
      <ul>
            <div *ngFor="let unidad of unidadesSeleccionadas" class="card p-3 my-2 shadow rounded">
                <p><strong>CamiÃ³n:</strong> {{ unidad.camion?.patente }} ({{ unidad.camion?.tipo }})</p>
                <p><strong>Semirremolque:</strong> {{ unidad.semirremolque?.patente }} ({{ unidad.semirremolque?.tipo }})</p>
                <p><strong>Acoplado:</strong> {{ unidad.acoplado?.patente }} ({{ unidad.acoplado?.tipo }})</p>
                <p><strong>Carga total:</strong> {{ unidad.cargaTotal }} kg</p>
                <p><strong>Subtotal:</strong> ${{ unidad.subtotal }}</p>
            </div>
        <hr>
      </ul>
    </div>

    <div class="acciones">
      <button class="btn-cancelar" (click)="cerrarResumen()">Cancelar</button>
      <button class="btn-confirmar" (click)="confirmarViaje()">âœ… Confirmar creaciÃ³n del viaje</button>
    </div>
  </div>
</div>
