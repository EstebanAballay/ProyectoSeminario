<div class="gestion-page">
  <div class="gestion-container">
    <div class="title-row">
      <h2 class="page-title">Gesti√≥n de Clientes</h2>
      <a routerLink="/admin" class="back-link">Volver al panel</a>
    </div>

    <div class="content-card">
      <div class="filtro-container" *ngIf="!cargando && !error">
        <input
          type="text"
          [(ngModel)]="filtro"
          placeholder="Filtrar por nombre, apellido o DNI"
          class="filtro-input"
        />
      </div>

      <p *ngIf="cargando" class="estado-texto">Cargando usuarios...</p>
      <p *ngIf="error" class="estado-texto estado-error">{{ error }}</p>
      <p *ngIf="mensaje" class="estado-texto estado-ok">{{ mensaje }}</p>

      <table *ngIf="!cargando && !error && usuariosFiltrados.length > 0" class="usuarios-table">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Apellido</th>
            <th>DNI</th>
            <th>Rol</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let usuario of usuariosFiltrados">
            <td>{{ usuario.nombre }}</td>
            <td>{{ usuario.apellido }}</td>
            <td>{{ usuario.dni }}</td>
            <td>{{ usuario.role }}</td>
            <td>
              <span [class]="usuario.estado === 'activo' ? 'badge-activo' : 'badge-eliminado'">
                {{ usuario.estado === 'activo' ? 'Activo' : 'Eliminado' }}
              </span>
            </td>
            <td class="acciones-col">
              <button
                type="button"
                class="accion-btn baja-btn"
                [disabled]="usuario.actualizando || usuario.estado === 'eliminado'"
                (click)="cambiarEstado(usuario, 'eliminado')">
                Dar de baja
              </button>

              <button
                type="button"
                class="accion-btn alta-btn"
                [disabled]="usuario.actualizando || usuario.estado === 'activo'"
                (click)="cambiarEstado(usuario, 'activo')">
                Dar de alta
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <p class="estado-texto" *ngIf="!cargando && !error && usuarios.length === 0">No hay usuarios para mostrar.</p>
      <p class="estado-texto" *ngIf="!cargando && !error && usuarios.length > 0 && usuariosFiltrados.length === 0">
        No hay resultados para el filtro aplicado.
      </p>
    </div>
  </div>
</div>
